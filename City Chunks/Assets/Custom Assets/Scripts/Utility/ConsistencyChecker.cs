// Copyright (c) Campbell Crowley. All rights reserved.
// Author: Campbell Crowley (github@campbellcrowley.com)
using UnityEngine;
using System;
#pragma warning disable 0162 // Unreachable code

public class ConsistencyChecker : MonoBehaviour {

  System.Random rand;
  private static bool checkComplete = false;
  // Last unity versions this version was tested on.
  private string[] lastUnityVersions = {"2017.1.2f1"};
  private const string lastAppVersion = "v0.0.6tg6m4c1g1r1tex2tr2";
  private const string lastPUNVersion = "1.86";

  void Start() {
    if (!Application.genuineCheckAvailable || !Application.genuine) {
      if (!Application.genuineCheckAvailable) {
        Debug.LogError("Genuine check unavailable");
      } else {
        GameData.quit(QuitReason.GENUINECHECKFAIL);
      }
    }

    Debug.Log("Unity Version: " + Application.unityVersion + "\nApp Version: " +
              Application.version + "\nGameData Version: " +
              GameData.longVersion + "\nBuild GUID: " + Application.buildGUID +
              "\nPUN Version: " + PhotonNetwork.versionPUN);
    if (Application.buildGUID == "") {
      Debug.Log("This is not a valid build");
    }

    if (Application.version != GameData.longVersion) {
      Debug.LogError("Version mismatch. Version must be updated in Edit->" +
                     "Player->Version and GameData.cs");
      GameData.quit(QuitReason.VERSIONMISMATCH);
    } else if (checkUnityVersions()) {
      Debug.LogWarning("Version mismatch. Unity.");
      // GameData.quit(QuitReason.VERSIONMISMATCH);
    } else if (GameData.longVersion != lastAppVersion) {
      Debug.LogError("Version mismatch. GameData.");
      GameData.quit(QuitReason.VERSIONMISMATCH);
    } else if (PhotonNetwork.versionPUN != lastPUNVersion) {
      Debug.LogError("Version mismatch. PUN.");
      GameData.quit(QuitReason.VERSIONMISMATCH);
    } else if (Application.version != lastAppVersion) {
      Debug.LogError("Version mismatch. App.");
      GameData.quit(QuitReason.VERSIONMISMATCH);
    }

    if (!randomNumCheck()) GameData.quit(QuitReason.RANDMISMATCH);
    if (!randomNumCheck2()) GameData.quit(QuitReason.RANDMISMATCH);
    checkComplete = true;
  }

  private bool checkUnityVersions() {
    foreach (string s in lastUnityVersions) {
      if (Application.unityVersion == s) return false;
    }
    return true;
  }

  public static bool isCheckComplete() { return checkComplete; }

  bool randomNumCheck() {
    // Checks that the random numbers provided on all devices are identical
    // since the generator relies on this being true in order to reduce network
    // bandwidth.
    double[] expectedlist = {
        0.258589452718659,    0.854977159693361,   0.367339716929635,
        0.617955091697143,    0.495575283419143,   0.82718584538772,
        0.971452591461806,    0.921567022298261,   0.082932062020028,
        0.632072602227364,    0.0307794381076374,  0.273862130136165,
        0.572570292080087,    0.0790469269636306,  0.539377213706904,
        0.691747648497926,    0.211219085478792,   0.470018780543478,
        0.796656529790096,    0.0790780196334599,  0.214648877836135,
        0.960680579748322,    0.105128098328192,   0.866262743652921,
        0.560805171057957,    0.383434218998735,   0.496002050347627,
        0.205790704677715,    0.317797131053078,   0.193148296416341,
        0.930575628266938,    0.598170756640924,   0.260054963296305,
        0.868505011717093,    0.408792745046687,   0.970631910939995,
        0.325036326574644,    0.638440097513814,   0.933529990694267,
        0.599553687311501,    0.12725899560715,    0.149649532115855,
        0.37493822554822,     0.371468639174229,   0.823765246115516,
        0.799212849139801,    0.789929956099917,   0.511750598210725,
        0.696775557797763,    0.127877652704659,   0.828340382700944,
        0.299170328909145,    0.453775544862158,   0.586047515545994,
        0.18774153487186,     0.660418696077736,   0.594922196397056,
        0.498834705212542,    0.209162346650456,   0.524943372479148,
        0.502149518813076,    0.333012493947992,   0.988037031603994,
        0.483378374708527,    0.504813606620214,   0.881129905991782,
        0.898923904587945,    0.201101652905858,   0.255281680848115,
        0.740164364567103,    0.901817692398009,   0.699468487268066,
        0.773243222745714,    0.668778877085437,   0.250737636932515,
        0.91547854892699,     0.506905034886163,   0.519080582782198,
        0.67852120878106,     0.900386474980221,   0.788512022601679,
        0.997167345135085,    0.996628358027259,   0.79285375857393,
        0.690998777603264,    0.597563134318945,   0.610133725036929,
        0.776676588587778,    0.363691405096879,   0.527662839054904,
        0.0717080063520502,   0.123934673668786,   0.383158416665699,
        0.193365626127164,    0.697735994913492,   0.427790508339084,
        0.376406309370141,    0.706159348462783,   0.120731002241713,
        0.908286697188526,    0.292307814253638,   0.270849373317719,
        0.833229389429665,    0.796389082817542,   0.33936563010298,
        0.831173037565859,    0.302541970881886,   0.660921786288229,
        0.895048737942729,    0.590178400552915,   0.0502849710408063,
        0.818245607809278,    0.135143300115663,   0.681499507595552,
        0.453235366127098,    0.37821484514429,    0.949854077282294,
        0.794671405476831,    0.785642379795035,   0.0770230982811298,
        0.504723596621642,    0.192764556125162,   0.0803706506641445,
        0.346994983659589,    0.447856550313466,   0.63096831908029,
        0.866239097838401,    0.976854139928172,   0.329413246982458,
        0.419564599366656,    0.612936578045104,   0.845983248597935,
        0.624031844839469,    0.0883428082281457,  0.850101503939415,
        0.970266414792401,    0.862024045019422,   0.315128850431707,
        0.339618392446832,    0.312783932458974,   0.647709057036652,
        0.815462319560099,    0.991034208792743,   0.286668306815749,
        0.0229392424332626,   0.878943450226888,   0.0435640230046418,
        0.0361634330061094,   0.745509075813698,   0.0667676758332027,
        0.561551410500683,    0.399552169441968,   0.376746101480325,
        0.701166402875058,    0.295350119143422,   0.446324565655703,
        0.646817528478251,    0.744886581201519,   0.946287578878127,
        0.369099215310579,    0.969148992546438,   0.987413120450179,
        0.321303393841397,    0.582264805483755,   0.942469343516263,
        0.234822651480708,    0.827211399016535,   0.848474993299914,
        0.658560265162289,    0.57429191590021,    0.334650822139648,
        0.913690644276184,    0.0491623296631325,  0.718874703961832,
        0.515471687780447,    0.105171427179673,   0.816018454644838,
        0.379204247789087,    0.0516448645161674,  0.00153198465776257,
        0.984150790602039,    0.121352516636882,   0.0305665610500456,
        0.960314031671879,    0.450415606820218,   0.625523457594925,
        0.524679854756538,    0.0417670393557134,  0.145873464711883,
        0.615278852458708,    0.143055015775866,   0.0135490517195077,
        0.656568585269418,    0.765326476546622,   0.978133110319326,
        0.734018412760467,    0.766299989896966,   0.272159504830912,
        0.771196619035302,    0.917767815253589,   0.0629249955820502,
        0.664359775215555,    0.984518568489942,   0.743977091155936,
        0.0826168852311638,   0.4401988938638,     0.368985608391923,
        0.416432069808446,    0.25075079605484,    0.669826661548497,
        0.921644710899165,    0.605050489122537,   0.599013116489636,
        0.331008726419419,    0.226044199534712,   0.95559994082693,
        0.330844535180761,    0.555976917294775,   0.604131695164429,
        0.208450930755795,    0.468522661583742,   0.555051894185623,
        0.077278374264612,    0.7407924499087,     0.51136692031816,
        0.670291046924093,    0.929172075786242,   0.305185238507197,
        0.636257818730668,    0.0752727939166468,  0.736185818787751,
        0.399586384836392,    0.128453451734247,   0.381818202967671,
        0.0798872737585973,   0.379100301479502,   0.522339400147246,
        0.699557834630626,    0.734269832137166,   0.494815665993288,
        0.294678922414164,    0.968702937461763,   0.437635344191285,
        0.937422533956087,    0.146756190874966,   0.588003121590243,
        0.936270677454896,    0.915776135360718,   0.253959556228462,
        0.307842063395233,    0.804846336974225,   0.461114751389769,
        0.635901686100243,    0.695923825118655,   0.181581996465839,
        0.663338610745658,    0.535906323481308,   0.602700365522271,
        0.664089817397338,    0.703516583751662,   0.917859493716555,
        0.669427773761297,    0.682162237671279,   0.755935130061552,
        0.375147739134332,    0.952941773437402,   0.167415144931253,
        0.661590582533549,    0.184252535544453,   0.638041077944469,
        0.0193292633720344,   0.415068399820043,   0.302017361066312,
        0.296289631769196,    0.40360459378157,    0.00740791019397225,
        0.91915020808538,     0.381354549145957,   0.559210453442862,
        0.848028309572501,    0.134384723442786,   0.326471710263971,
        0.641095421109859,    0.932741234979006,   0.157413300200092,
        0.0667580450264542,   0.717424147165112,   0.372518321672696,
        0.0066704638333388,   0.126945500321195,   0.211685156548249,
        0.860748817613697,    0.515305299086173,   0.0962287541926972,
        0.475486402621254,    0.879610522594122,   0.666685576395451,
        0.141345712422089,    0.533817940174517,   0.139348280680994,
        0.668852913504864,    0.554916128308939,   0.356565681917856,
        0.405931246655961,    0.173457339952447,   0.478374626710254,
        0.820019330279911,    0.703160451121237,   0.538510524918563,
        0.114823951439384,    0.945914463580546,   0.163388001808612,
        0.596029901688932,    0.537144317076143,   0.491831427203413,
        0.0571106761028574,   0.154122474675124,   0.585933483478582,
        0.280448727440298,    0.49553721654021,    0.286256197041951,
        0.0260694325091641,   0.127772642359032,   0.0449042548634597,
        0.969188164439606,    0.464413135063096,   0.0585027179021867,
        0.896086114410351,    0.122832291816749,   0.925229967071316,
        0.187388579914062,    0.215989756964142,   0.842844024227394,
        0.444386502003477,    0.902113845991955,   0.970996721634174,
        0.730441808575039,    0.103951104033716,   0.440909807775593,
        0.100302624097235,    0.91263557035133,    0.13149066368653,
        0.0920695942323979,   0.511133247293128,   0.840689303279244,
        0.185615724039085,    0.732976175254665,   0.470401044222713,
        0.127040589753092,    0.011073267558158,   0.821107804691935,
        0.7705994619851,      0.0185134206053398,  0.608587973103201,
        0.951959700766932,    0.452863156540721,   0.712072104081545,
        0.912179179914379,    0.503817400664006,   0.202460618318273,
        0.747932818135215,    0.716068226246195,   0.262250643345644,
        0.438207900821328,    0.202188381088054,   0.814423799894016,
        0.0713184075762138,   0.0848966543958041,  0.696455013796899,
        0.306215703164328,    0.324134500848192,   0.683721430452411,
        0.458892893725491,    0.26937545988214,    0.674429411848276,
        0.515656735056851,    0.00755601190382429, 0.519184669255831,
        0.0929445540965277,   0.516325007898884,   0.75234103098155,
        0.146323537987808,    0.392268713746345,   0.920371673498476,
        0.177297148936101,    0.471320353667867,   0.953739113618498,
        0.404636123406066,    0.242198120915423,   0.0876900460979389,
        0.89967831405796,     0.645545154179235,   0.407496090236817,
        0.134694104611266,    0.776168123249043,   0.22891413989892,
        0.672597769961039,    0.822694134350258,   0.836703835444853,
        0.325032568222393,    0.178059712135261,   0.213791505998835,
        0.377456490126185,    0.610715581854207,   0.258732236576608,
        0.674784266704127,    0.378330748238755,   0.098141747106864,
        0.4312908241671,      0.480639347099065,   0.499124042922223,
        0.307435980675479,    0.669981058998956,   0.416127354566067,
        0.302782304260313,    0.102387663955981,   0.308572136009378,
        0.127556538734379,    0.662039777572285,   0.973274241189134,
        0.141826029932977,    0.248624273225956,   0.248192818950951,
        0.371422445574506,    0.128155991029067,   0.110342994849357,
        0.306264940326225,    0.848177311871283,   0.0106432233055323,
        0.999645145144148,    0.137325986818097,   0.90941426479696,
        0.0878938450887305,   0.612305206997462,   0.0172009649766614,
        0.444905050306071,    0.476342478988852,   0.976141359180278,
        0.617589369238163,    0.0749094849801201,  0.162748217658488,
        0.82618257488412,     0.74259634583378,    0.268923879726289,
        0.945864016164962,    0.651054040832005,   0.397352335228283,
        0.0360736446623102,   0.00653811358219856, 0.665825128399686,
        0.922649199572694,    0.824420458089756,   0.812050911044726,
        0.837058690300704,    0.187706581404296,   0.2686454473383,
        0.125897660910104,    0.765151283128723,   0.593514616877546,
        0.813827186270537,    0.198441787715276,   0.402189389058477,
        0.480552377868701,    0.35638133918698,    0.317891129440577,
        0.672941468038103,    0.564839634841699,   0.401057179272667,
        0.470263338401105,    0.651728263428308,   0.705035328727698,
        0.272498491347068,    0.12101842515218,    0.9962146491726,
        0.0506250416164403,   0.317405571843221,   0.43657336218123,
        0.411134128650247,    0.18371586417021,    0.859510543690767,
        0.984445333939253,    0.541113657197502,   0.254662694993738,
        0.196816037034996,    0.801203357428873,   0.73513659775962,
        0.428861886928259,    0.73151250590175,    0.294414077556885,
        0.344259496938558,    0.880065415464372,   0.0752852997161845,
        0.505878020779173,    0.965861105809855,   0.369874156252422,
        0.89024972631142,     0.70516414973194,    0.746381696661181,
        0.218298838109848,    0.628458444321742,   0.214480678650774,
        0.986218206578036,    0.8523577804921,     0.147027569891432,
        0.681379794460433,    0.381535542375192,   0.569757763096019,
        0.61523487400973,     0.0358553328718316,  0.452569983644676,
        0.839783560410041,    0.394385155008354,   0.470737205571838,
        0.249255119938988,    0.933761770806164,   0.123156487999091,
        0.896311368279304,    0.514691272058846,   0.986507182934558,
        0.427641403129157,    0.967777318306164,   0.818457938180518,
        0.182758341162819,    0.841804894079363,   0.437247584777534,
        0.718817122149662,    0.420140710854968,   0.973990855260748,
        0.314834854712167,    0.669089499241249,   0.747647808747202,
        0.8213384881715,      0.375278795778416,   0.731145880525534,
        0.0197269832807253,   0.590060178930899,   0.070376451625664,
        0.00540757505474965,  0.263054266228831,   0.678046869429782,
        0.838825229480316,    0.914170614869413,   0.745005322967193,
        0.866772674427728,    0.376482178632394,   0.0616074772838538,
        0.892526958553366,    0.66407312669981,    0.528613521032321,
        0.651057034102761,    0.470109015456452,   0.731173294471192,
        0.431546841949013,    0.5492093388686,     0.88081063557454,
        0.393142190479274,    0.61093941079962,    0.121211899966566,
        0.127300586610707,    0.0913196155295333,  0.311159090749528,
        0.564350188041269,    0.352180607780898,   0.35780846344205,
        0.613744754164361,    0.925612945540628,   0.649379832041161,
        0.603964531144111,    0.872772941306593,   0.872154293522311,
        0.230629529445725,    0.232238241579495,   0.986077751026525,
        0.335450148831797,    0.957532387672706,   0.236604023834972,
        0.386911096231505,    0.633549002294219,   0.960994258504824,
        0.0441053942982598,   0.107877711350041,   0.298928810888403,
        0.846690268650041,    0.223515239182634,   0.357930408491721,
        0.183297620705933,    0.469157880390602,   0.0174703323363654,
        0.117401126361173,    0.0941140377400974,  0.940680346889738,
        0.466411920481553,    0.132634633748156,   0.390899972706521,
        0.447417339984056,    0.606586987900821,   0.928092863842888,
        0.409555174135396,    0.909240286755022,   0.139878154797423,
        0.674696381052349,    0.258977956259147,   0.703078868194986,
        0.484508126734061,    0.543179322752719,   0.171180204568049,
        0.884483025821151,    0.20803160276638,    0.191278930376879,
        0.697513014868606,    0.923984310088672,   0.593469078463255,
        0.00381077360539267,  0.0331865488706094,  0.150639268639795,
        0.844747170267975,    0.431715554293113,   0.961280635074377,
        0.910391123457994,    0.00715776626353979, 0.99752008169774,
        0.239824657905765,    0.694724244389089,   0.732894786509171,
        0.197457912469962,    0.971651573186578,   0.529159373384509,
        0.501569624292464,    0.792270826079078,   0.786352183104657,
        0.352120998013821,    0.178879493465125,   0.442270071917339,
        0.263481243636218,    0.120121084209588,   0.514408632886786,
        0.29511803728301,     0.813503719779432,   0.0728759705428388,
        0.513183238223746,    0.751582066412821,   0.507877245316225,
        0.107079208878372,    0.110243360097633,   0.0965939560423577,
        0.700855688983973,    0.771687676092464,   0.399739847238986,
        0.193442060236559,    0.475765766797478,   0.0774276145163121,
        0.426523239550424,    0.617284348056318,   0.122888103650365,
        0.787757156783602,    0.495816887587224,   0.816707884341808,
        0.439597624558768,    0.364387042524473,   0.0287706898659331,
        0.876062167285039,    0.0709793060417191,  0.135155632223541,
        0.678095692153133,    0.945930948455786,   0.416107064772447,
        0.486389869584884,    0.893567413507759,   0.936592592828252,
        0.449783579655822,    0.0730594941755102,  0.0319757070541269,
        0.767838574837818,    0.434625356660516,   0.929730151747228,
        0.570996842147315,    0.622540309849447,   0.571836140738724,
        0.945137629725569,    0.701641024882738,   0.15494368884477,
        0.0895617488257409,   0.137182581767991,   0.763500136213144,
        0.910290015819618,    0.281141691972102,   0.0437238612415846,
        0.764174379764206,    0.317550295180432,   0.704014019437141,
        0.0280187633019028,   0.401550623775251,   0.87691112695118,
        0.623092390887017,    0.440123744048236,   0.719606359358694,
        0.740038670478407,    0.672453852217856,   0.180513208350406,
        0.525597113895042,    0.0783153791345262,  0.19985153535374,
        0.454602217513417,    0.491801035353821,   0.320822077952708,
        0.987865865690571,    0.289340657782434,   0.853784211843174,
        0.212598087830748,    0.5066154648115,     0.452093026345639,
        0.052533504577602,    0.122047329378336,   0.660373023087332,
        0.000751926564030315, 0.474511543509789,   0.194068179090539,
        0.512063241336524,    0.237971948104898,   0.226324589097092,
        0.67606839429404,     0.813936017367028,   0.713054205157354,
        0.410995478933209,    0.371468200521296,   0.87320795882177,
        0.57737348954071,     0.276037539483997,   0.113803278707808,
        0.941864286056657,    0.281656184364881,   0.768756098006273,
        0.359238052907976,    0.438522164914069,   0.249547998537099,
        0.102410184267168,    0.967514419447405,   0.476809558680658,
        0.762748209649114,    0.435778472309829,   0.0870735128815628,
        0.53166061990506,     0.526202431659308,   0.0912257060833395,
        0.0279456251431003,   0.214082745934875,   0.688496418617897,
        0.465915648017971,    0.251624190365721,   0.566915785226466,
        0.142232869817984,    0.46400113099441,    0.558650573510048,
        0.238648922293749,    0.243940929530161,   0.309559281128253,
        0.840613482445764,    0.0160800525993482,  0.242253036816722,
        0.21841189368554,     0.0203514462431667,  0.812531099101776,
        0.09103600219406,     0.776819615520919,   0.419541951929937,
        0.920432406440579,    0.526331072918294,   0.0308216232949969,
        0.632427397944232,    0.786669180629155,   0.786015124891892,
        0.728152531072568,    0.260439050970804,   0.671056162878432,
        0.0840917192791084,   0.212067263299631,   0.255285443856979,
        0.474405282863605,    0.167054549403048,   0.0619089193930425,
        0.0325944763760057,   0.561293436941362,   0.0337845026672746,
        0.895391385022267,    0.92151283981349,    0.469125085263106,
        0.677720095812213,    0.582418437387058,   0.0189802129841317,
        0.32911559209652,     0.576079111348874,   0.936692796152408,
        0.844382160736426,    0.976079029019959,   0.649763347417937,
        0.358920981808994,    0.271221568934257,   0.855146268780877,
        0.00713398680423106,  0.81587836184347,    0.958797302077896,
        0.214091135754292,    0.298861098614922,   0.189715270972678,
        0.53432130885046,     0.580939432876622,   0.430216628327135,
        0.663259188487781,    0.317136082480259,   0.774815844267055,
        0.631839185316041,    0.258195045058706,   0.997099839615216,
        0.913137444720202,    0.642332782336666,   0.083658650090759,
        0.96814893836535,     0.114956973174101,   0.127056268102981,
        0.0606209701209427,   0.649210837506322,   0.671184804137417,
        0.0236876364907658,   0.816549036100762,   0.82787187855126,
        0.571923989137599,    0.429291432457646,   0.0707237799981254,
        0.136734854027971,    0.503152286402486,   0.781850634972495,
        0.592026255369199,    0.157269200383345,   0.392238705135993,
        0.430069734077002,    0.774399431317299,   0.564193597326145,
        0.120647057947073,    0.253058602685602,   0.837854189722731,
        0.500976146897756,    0.562763122638112,   0.455362169284077,
        0.958359242863189,    0.679904754590199,   0.904894307211458,
        0.913005159661642,    0.0278331246356634,  0.148207150468699,
        0.077839358280338,    0.929629549351348,   0.200497788936132,
        0.718411414752906,    0.503981700401745,   0.0340277268709744,
        0.366771046708697,    0.0568219353709472,  0.906622393478929,
        0.759645536895676,    0.759921877533161,   0.0167458355504767,
        0.309569570380063,    0.410200585802179,   0.479281892757528,
        0.2738396973693,      0.0690760626779292,  0.80283287577463,
        0.0387405967520273,   0.233232690130003,   0.737438475125208,
        0.170653490429117,    0.940315813729687,   0.966749822705402,
        0.0492169098226432,   0.130991420769594,   0.44871304857019,
        0.952773389384511,    0.519705936089021,   0.782521309229788,
        0.461100831842563,    0.515102053766652,   0.522669038978717,
        0.311078243102449,    0.37681297649481,    0.48640645085201,
        0.472281064592433,    0.18182566956702,    0.677987307625817,
        0.118399007766693,    0.360993671399073,   0.971566555542669,
        0.525453000574118,    0.88741436781707,    0.515620127560394,
        0.667200699293614,    0.560660333168069,   0.59601329993271,
        0.406145259461433,    0.827367822093595,   0.231191706020009,
        0.952120917826947,    0.393299223572621,   0.245311815405875,
        0.687106318626137};
    rand = new System.Random(973);
    for (int i = 0; i < expectedlist.Length; i++) {
      double nextRand = rand.NextDouble();
      if (!AboutEqual(expectedlist[i], nextRand)) {
        Debug.LogError("RANDOM NUMBER MISMATCH[1] (" + i + ")\nReceived: " +
                       nextRand);
        return false;
      }
    }
    return true;
  }

  bool randomNumCheck2() {
    // Checks that the random numbers provided on all devices are identical
    // since the generator relies on this being true in order to reduce network
    // bandwidth.
    double[] expectedlist = {
        0.637348353862762,   0.460022032260895,   0.173384442925453,
        0.870165348052979,   0.930347919464111,   0.557033479213715,
        0.545009672641754,   0.47929984331131,    0.649302899837494,
        0.739196121692657,   0.340225607156754,   0.278819710016251,
        0.350081235170364,   0.779255509376526,   0.730195939540863,
        0.40681666135788,    0.860811114311218,   0.880463838577271,
        0.209843546152115,   0.424894273281097,   0.880339741706848,
        0.411202013492584,   0.497780025005341,   0.0593398883938789,
        0.99969744682312,    0.330895930528641,   0.90986156463623,
        0.399878799915314,   0.524506509304047,   0.741683185100555,
        0.651894986629486,   0.838722825050354,   0.976891279220581,
        0.203632861375809,   0.304220825433731,   0.51288777589798,
        0.52470988035202,    0.11734165251255,    0.984119653701782,
        0.404337704181671,   0.48030287027359,    0.313603311777115,
        0.219052821397781,   0.233330756425858,   0.44792765378952,
        0.795478582382202,   0.428730547428131,   0.898648262023926,
        0.443400084972382,   0.269848495721817,   0.804259061813354,
        0.594640791416168,   0.139094009995461,   0.40259176492691,
        0.731591522693634,   0.547389566898346,   0.0508141592144966,
        0.0817637518048286,  0.949074268341064,   0.647251188755035,
        0.100868120789528,   0.928488492965698,   0.0938886553049088,
        0.939981937408447,   0.899402976036072,   0.174786701798439,
        0.805739998817444,   0.0120575446635485,  0.118004694581032,
        0.241234809160233,   0.53739994764328,    0.142638698220253,
        0.376031339168549,   0.250399261713028,   0.745661437511444,
        0.112024679780006,   0.160266891121864,   0.8864825963974,
        0.0152473468333483,  0.730544745922089,   0.5201136469841,
        0.79155445098877,    0.564145147800446,   0.375880062580109,
        0.394229710102081,   0.3156478703022,     0.811860918998718,
        0.863612294197083,   0.937928915023804,   0.748373448848724,
        0.0193535108119249,  0.593778550624847,   0.143802300095558,
        0.548240482807159,   0.534974277019501,   0.717413723468781,
        0.93803608417511,    0.679441154003143,   0.0964808613061905,
        0.135446444153786,   0.856896996498108,   0.927862644195557,
        0.69312196969986,    0.227865487337112,   0.124405279755592,
        0.944516897201538,   0.711508095264435,   0.776914834976196,
        0.812068343162537,   0.560334026813507,   0.718063175678253,
        0.675122916698456,   0.165305629372597,   0.540565669536591,
        0.458885014057159,   0.732016384601593,   0.748046100139618,
        0.233121186494827,   0.721553266048431,   0.6258664727211,
        0.928173184394836,   0.538309395313263,   0.600593864917755,
        0.652101933956146,   0.579626977443695,   0.259066969156265,
        0.379029929637909,   0.351552039384842,   0.427143514156342,
        0.587612092494965,   0.229315668344498,   0.802639484405518,
        0.162304893136024,   0.382714688777924,   0.630875647068024,
        0.0655161216855049,  0.534152328968048,   0.0130687970668077,
        0.843600034713745,   0.681515634059906,   0.523705542087555,
        0.430941760540009,   0.975051164627075,   0.56926566362381,
        0.942368984222412,   0.0549445226788521,  0.367922216653824,
        0.386140048503876,   0.450828969478607,   0.106073394417763,
        0.921181082725525,   0.902908444404602,   0.946712732315063,
        0.364856392145157,   0.011324287392199,   0.203678280115128,
        0.380196392536163,   0.553213894367218,   0.919737696647644,
        0.900183200836182,   0.916067361831665,   0.731251537799835,
        0.544584572315216,   0.782883763313293,   0.625409662723541,
        0.696911990642548,   0.51518303155899,    0.787597894668579,
        0.746821939945221,   0.918457388877869,   0.656968295574188,
        0.192782670259476,   0.0871851518750191,  0.10011114180088,
        0.924956202507019,   0.702897965908051,   0.281944066286087,
        0.68253368139267,    0.478858411312103,   0.439516484737396,
        0.872146248817444,   0.897143363952637,   0.727838695049286,
        0.11210860311985,    0.878245949745178,   0.811160206794739,
        0.073820598423481,   0.679520547389984,   0.209803968667984,
        0.559465944766998,   0.592488586902618,   0.45760041475296,
        0.0802717283368111,  0.291389614343643,   0.305674701929092,
        0.103240147233009,   0.578711330890656,   0.0514156892895699,
        0.557034909725189,   0.597714006900787,   0.815865635871887,
        0.6297487616539,     0.020925285294652,   0.724713742733002,
        0.0891158655285835,  0.168990984559059,   0.0861756876111031,
        0.65435403585434,    0.928060054779053,   0.77811861038208,
        0.701609432697296,   0.645959317684174,   0.750527501106262,
        0.939093470573425,   0.492050349712372,   0.958451747894287,
        0.910604238510132,   0.439594447612762,   0.162132754921913,
        0.177382841706276,   0.116161599755287,   0.945371508598328,
        0.343290954828262,   0.513268411159515,   0.449270665645599,
        0.234567075967789,   0.413349807262421,   0.814435839653015,
        0.149205341935158,   0.230260640382767,   0.248965293169022,
        0.14093329012394,    0.50032240152359,    0.604410111904144,
        0.231859236955643,   0.129986181855202,   0.653890073299408,
        0.130551710724831,   0.479521334171295,   0.604068219661713,
        0.495209157466888,   0.5642951130867,     0.0650099590420723,
        0.668220460414886,   0.681939780712128,   0.241840273141861,
        0.322901874780655,   0.977737903594971,   0.179700866341591,
        0.532913386821747,   0.387956202030182,   0.760167121887207,
        0.615508496761322,   0.914066076278687,   0.228102594614029,
        0.173941388726234,   0.717002809047699,   0.994604349136353,
        0.974777698516846,   0.266669422388077,   0.389890253543854,
        0.494048655033112,   0.923655271530151,   0.987649083137512,
        0.320237666368485,   0.675202548503876,   0.0418610610067844,
        0.36945429444313,    0.0706790760159492,  0.0592114999890327,
        0.008861661888659,   0.973742127418518,   0.541024744510651,
        0.930383563041687,   0.204369932413101,   0.822357177734375,
        0.27094629406929,    0.820913672447205,   0.321899920701981,
        0.53054291009903,    0.663964807987213,   0.379183709621429,
        0.410795390605927,   0.98657751083374,    0.972132325172424,
        0.0603443458676338,  0.454847395420074,   0.391490519046783,
        0.365406066179276,   0.314652591943741,   0.691927492618561,
        0.935390472412109,   0.964481949806213,   0.187493816018105,
        0.438279569149017,   0.753008127212524,   0.335307747125626,
        0.559346616268158,   0.431405246257782,   0.978134751319885,
        0.932211637496948,   0.750425457954407,   0.00803434941917658,
        0.210718423128128,   0.34285905957222,    0.690691769123077,
        0.0272015370428562,  0.205209404230118,   0.452881157398224,
        0.712298810482025,   0.532990038394928,   0.42708557844162,
        0.0485173538327217,  0.195102483034134,   0.0937366560101509,
        0.326602727174759,   0.108008280396461,   0.0509015396237373,
        0.355764180421829,   0.945058345794678,   0.598155081272125,
        0.907166957855225,   0.387687981128693,   0.929500699043274,
        0.448595821857452,   0.696946680545807,   0.964022994041443,
        0.177016749978065,   0.707086980342865,   0.755487680435181,
        0.0297319926321507,  0.725533306598663,   0.579100549221039,
        0.815374970436096,   0.86273455619812,    0.544920027256012,
        0.0130720157176256,  0.306772500276566,   0.504049956798553,
        0.691603004932404,   0.566713035106659,   0.428425133228302,
        0.871505498886108,   0.710138857364655,   0.86771023273468,
        0.565428912639618,   0.235894232988358,   0.606114685535431,
        0.116318002343178,   0.0216938275843859,  0.567539751529694,
        0.594169914722443,   0.00322651909664273, 0.378832995891571,
        0.72337132692337,    0.426980316638947,   0.11589802801609,
        0.275049477815628,   0.747137010097504,   0.639544665813446,
        0.549049556255341,   0.827817916870117,   0.893786430358887,
        0.780094742774963,   0.40190201997757,    0.111076608300209,
        0.391749799251556,   0.713867604732513,   0.176076784729958,
        0.543683111667633,   0.253724008798599,   0.212952643632889,
        0.484348952770233,   0.545848548412323,   0.85852062702179,
        0.0585335567593575,  0.831627607345581,   0.402151525020599,
        0.0768891647458076,  0.476558864116669,   0.530030429363251,
        0.189644247293472,   0.329887181520462,   0.0432411469519138,
        0.125111117959023,   0.667409360408783,   0.572880566120148,
        0.761188864707947,   0.474789798259735,   0.127185836434364,
        0.927936673164368,   0.560087502002716,   0.599326908588409,
        0.0768871381878853,  0.189579874277115,   0.286881238222122,
        0.757951140403748,   0.346855312585831,   0.411958634853363,
        0.861714363098145,   0.00212335609830916, 0.482169210910797,
        0.0747703388333321,  0.436910808086395,   0.915589213371277,
        0.592280328273773,   0.169955149292946,   0.553800642490387,
        0.707547724246979,   0.744885385036469,   0.54394942522049,
        0.0864076688885689,  0.649819076061249,   0.662562429904938,
        0.716022551059723,   0.0789809301495552,  0.676818549633026,
        0.4179727435112,     0.330475002527237,   0.228527575731277,
        0.197277456521988,   0.320061832666397,   0.753272175788879,
        0.13768769800663,    0.201995044946671,   0.167201533913612,
        0.940988302230835,   0.273881584405899,   0.0725233629345894,
        0.390494525432587,   0.973084568977356,   0.774871468544006,
        0.681283295154572,   0.218631058931351,   0.966707229614258,
        0.428999245166779,   0.538976013660431,   0.989731431007385,
        0.522609889507294,   0.27663066983223,    0.0465050972998142,
        0.245248109102249,   0.37466099858284,    0.10135592520237,
        0.84825336933136,    0.809023380279541,   0.0683630779385567,
        0.934900879859924,   0.537133395671844,   0.986820816993713,
        0.553842127323151,   0.174248948693275,   0.981322526931763,
        0.641537010669708,   0.151805892586708,   0.457894027233124,
        0.487797796726227,   0.0764694288372993,  0.603992402553558,
        0.368641763925552,   0.341161042451859,   0.755671381950378,
        0.727617561817169,   0.335808902978897,   0.772775411605835,
        0.267656117677689,   0.79429566860199,    0.0351290740072727,
        0.713270604610443,   0.826311707496643,   0.766518712043762,
        0.378561913967133,   0.375723659992218,   0.669155180454254,
        0.24213781952858,    0.919034004211426,   0.481047689914703,
        0.244263797998428,   0.333158880472183,   0.416413724422455,
        0.798203468322754,   0.922166705131531,   0.267478853464127,
        0.284527450799942,   0.307322174310684,   0.0827090814709663,
        0.269660502672195,   0.716447651386261,   0.814557909965515,
        0.095915213227272,   0.997157454490662,   0.49673455953598,
        0.584906280040741,   0.0674229934811592,  0.935044407844543,
        0.561423003673553,   0.93760097026825,    0.161439076066017,
        0.244678050279617,   0.172141805291176,   0.29306235909462,
        0.465982258319855,   0.355850726366043,   0.208878427743912,
        0.110269322991371,   0.232763797044754,   0.766988754272461,
        0.935630917549133,   0.908780813217163,   0.593516886234283,
        0.989782214164734,   0.8212571144104,     0.06070626527071,
        0.0412536896765232,  0.765257239341736,   0.308446317911148,
        0.334098249673843,   0.354266673326492,   0.70157915353775,
        0.508096158504486,   0.735357701778412,   0.249566584825516,
        0.330392152070999,   0.0592447593808174,  0.374604970216751,
        0.870495676994324,   0.851905345916748,   0.891147494316101,
        0.528613746166229,   0.22575369477272,    0.141239657998085,
        0.188420444726944,   0.850556254386902,   0.0734244659543037,
        0.292729407548904,   0.901319980621338,   0.0442891158163548,
        0.48591810464859,    0.444815576076508,   0.657850921154022,
        0.397470533847809,   0.753407120704651,   0.0778055265545845,
        0.691991865634918,   0.510577619075775,   0.195948630571365,
        0.199734479188919,   0.631420910358429,   0.334620147943497,
        0.982043862342834,   0.332413345575333,   0.77067244052887,
        0.705957591533661,   0.721728026866913,   0.0437258519232273,
        0.138847127556801,   0.0290404595434666,  0.340855270624161,
        0.56259149312973,    0.336902290582657,   0.927749514579773,
        0.116960063576698,   0.423996984958649,   0.510775148868561,
        0.19301250576973,    0.796503782272339,   0.831537842750549,
        0.370793849229813,   0.97215461730957,    0.412185490131378,
        0.953686237335205,   0.20733717083931,    0.140689507126808,
        0.586725652217865,   0.878292560577393,   0.144539013504982,
        0.909870743751526,   0.280776053667068,   0.681281626224518,
        0.275371462106705,   0.669665515422821,   0.349061399698257,
        0.989197611808777,   0.555385768413544,   0.601880967617035,
        0.779008388519287,   0.329053789377213,   0.390143096446991,
        0.93023669719696,    0.994087934494019,   0.903210163116455,
        0.272569686174393,   0.65970367193222,    0.577150642871857,
        0.949113488197327,   0.102935805916786,   0.256719976663589,
        0.792919874191284,   0.62809294462204,    0.919031023979187,
        0.840823173522949,   0.0272361077368259,  0.0559116676449776,
        0.910318613052368,   0.253664046525955,   0.560225665569305,
        0.716184198856354,   0.656085431575775,   0.984208345413208,
        0.80013120174408,    0.36506000161171,    0.887503385543823,
        0.484855711460114,   0.502658784389496,   0.963428139686584,
        0.264552026987076,   0.227023631334305,   0.303077608346939,
        0.106167569756508,   0.282871752977371,   0.41511195898056,
        0.281167179346085,   0.925264120101929,   0.43325263261795,
        0.261321693658829,   0.055250771343708,   0.289398103952408,
        0.726436316967011,   0.0185128469020128,  0.268689900636673,
        0.690640389919281,   0.91762387752533,    0.38095611333847,
        0.428420007228851,   0.050019271671772,   0.611587345600128,
        0.756926536560059,   0.664097130298615,   0.00801932904869318,
        0.49366968870163,    0.0705808475613594,  0.0886279419064522,
        0.318596035242081,   0.541516959667206,   0.350150853395462,
        0.0976870208978653,  0.939937353134155,   0.802552223205566,
        0.915346741676331,   0.337199360132217,   0.402518093585968,
        0.411604583263397,   0.113542214035988,   0.707142412662506,
        0.333161860704422,   0.0306886471807957,  0.764519572257996,
        0.212125450372696,   0.593253076076508,   0.704643309116364,
        0.269499570131302,   0.278309017419815,   0.84692645072937,
        0.383439242839813,   0.817137718200684,   0.189668208360672,
        0.223870545625687,   0.527072489261627,   0.239245921373367,
        0.219532519578934,   0.155083909630775,   0.883963108062744,
        0.869006991386414,   0.908672213554382,   0.379333913326263,
        0.964637279510498,   0.652515590190887,   0.684691727161407,
        0.272568374872208,   0.858407497406006,   0.395404160022736,
        0.880274534225464,   0.7173792719841,     0.28603520989418,
        0.438360154628754,   0.992600679397583,   0.278706580400467,
        0.156254425644875,   0.173627391457558,   0.43313056230545,
        0.447376310825348,   0.347613602876663,   0.464188873767853,
        0.942470550537109,   0.182192221283913,   0.352856308221817,
        0.643976271152496,   0.502239167690277,   0.11801315844059,
        0.0654878690838814,  0.309856921434402,   0.648723423480988,
        0.567907512187958,   0.508617579936981,   0.612421572208405,
        0.871194243431091,   0.0619028881192207,  0.999942421913147,
        0.733469545841217,   0.853691935539246,   0.302139312028885,
        0.349175244569778,   0.0361372269690037,  0.750689387321472,
        0.921275019645691,   0.666538178920746,   0.920498967170715,
        0.0520675256848335,  0.617164194583893,   0.586866796016693,
        0.631862699985504,   0.521378338336945,   0.356380134820938,
        0.458535850048065,   0.785701155662537,   0.220138102769852,
        0.25411120057106,    0.94865894317627,    0.0217765588313341,
        0.995563864707947,   0.955868363380432,   0.687709033489227,
        0.844268918037415,   0.964433908462524,   0.833340167999268,
        0.0359660424292088,  0.456540167331696,   0.323294192552567,
        0.519355833530426,   0.421583592891693,   0.953802466392517,
        0.382586538791656,   0.500141680240631,   0.484089076519012,
        0.939403891563416,   0.467969596385956,   0.111014619469643,
        0.521841585636139,   0.355413466691971,   0.815567851066589,
        0.943091034889221,   0.936047196388245,   0.269140750169754,
        0.0193865317851305,  0.208017498254776,   0.719811260700226,
        0.885573744773865,   0.651727378368378,   0.362012654542923,
        0.0595663860440254,  0.462226808071136,   0.528631985187531,
        0.304720669984818,   0.0786411836743355,  0.622980892658234,
        0.528986394405365,   0.36110070347786,    0.729937016963959,
        0.00604665372520685, 0.871495962142944,   0.325327426195145,
        0.566071093082428,   0.250421553850174,   0.0620741918683052,
        0.378585398197174,   0.334460645914078,   0.0360168255865574,
        0.856120824813843,   0.0632506683468819,  0.123226657509804,
        0.325256615877151,   0.211626917123795,   0.87923789024353,
        0.194187432527542,   0.201582103967667,   0.865928173065186,
        0.836547136306763,   0.0243107117712498,  0.817721605300903,
        0.585849940776825,   0.584920227527618,   0.377440750598907,
        0.69620019197464,    0.564498126506805,   0.382711946964264,
        0.887965202331543,   0.727588951587677,   0.468175113201141,
        0.573427975177765,   0.729245245456696,   0.68469625711441,
        0.600424587726593,   0.624185502529144,   0.668938815593719,
        0.678137719631195,   0.31738868355751,    0.576988995075226,
        0.602672755718231,   0.398236572742462,   0.624241530895233,
        0.0861759260296822,  0.42465740442276,    0.269993931055069,
        0.0449112690985203,  0.231405287981033,   0.799202561378479,
        0.771630167961121,   0.356580048799515,   0.237171322107315,
        0.0869610384106636,  0.293503910303116,   0.10517729818821,
        0.351535826921463,   0.899297595024109,   0.230058699846268,
        0.040162805467844,   0.192262798547745,   0.792282223701477,
        0.430322468280792,   0.355249673128128,   0.618114769458771,
        0.970928549766541,   0.497326791286469,   0.829945921897888,
        0.762664318084717,   0.137178674340248,   0.186671152710915,
        0.567884981632233,   0.726247847080231,   0.000687360821757466,
        0.605243384838104,   0.814451336860657,   0.681485235691071,
        0.993173956871033,   0.978111386299133,   0.292982131242752,
        0.725889980792999,   0.036384467035532,   0.639932334423065,
        0.525893151760101,   0.672456800937653,   0.891583204269409,
        0.222672373056412,   0.067492850124836,   0.488251864910126,
        0.115701213479042,   0.362983971834183,   0.934311866760254,
        0.397496163845062,   0.950596213340759,   0.807343721389771,
        0.349227577447891,   0.494194805622101,   0.773227572441101,
        0.0446152724325657,  0.66656905412674,    0.406419694423676,
        0.861192584037781,   0.422590553760529,   0.750374436378479,
        0.382527649402618,   0.840619325637817,   0.469501674175262,
        0.552451908588409,   0.910485625267029,   0.635833323001862,
        0.586499154567719,   0.922936320304871,   0.474803030490875,
        0.438099086284637,   0.144292250275612,   0.305587440729141,
        0.523682534694672,   0.817591428756714,   0.158337011933327,
        0.0735369995236397,  0.135406389832497,   0.0593631342053413,
        0.382510364055634,   0.598374307155609,   0.18795171380043,
        0.581253230571747,   0.854141235351563,   0.76231324672699,
        0.414443671703339,   0.989149689674377,   0.218535453081131,
        0.627531349658966,   0.327314525842667,   0.897121071815491,
        0.818119406700134,   0.0409525670111179,  0.619364202022552,
        0.595062553882599};
    UnityEngine.Random.InitState(1678);
    for (int i = 0; i < expectedlist.Length; i++) {
      double nextRand = UnityEngine.Random.value;
      if (!AboutEqual(expectedlist[i], nextRand)) {
        Debug.LogError("RANDOM NUMBER MISMATCH[2] (" + i + ")\nReceived: " +
                       nextRand);
        return false;
      }
    }
    return true;
  }

  bool AboutEqual(double x, double y) {
    // This check is a workaround for imprecision issues comparing large
    // doubles. We can't compare exactly equal, so this is the next closest
    // thing.

    // TODO: 1E-15 was causing issues, but 1E-14 may be too imprecise. Not sure.
    double epsilon = Math.Max(Math.Abs(x), Math.Abs(y)) * 1E-14;
    return Math.Abs(x - y) <= epsilon;
   }
}
